## apache_directadmin.conf
## Paste this into DirectAdmin -> Custom HTTPD Configurations for your domain
## Replace /home/username/domains/your-domain.com/public_html and your-domain.com

# Enable required modules (must be enabled server-side)
# LoadModule proxy_module modules/mod_proxy.so
# LoadModule proxy_http_module modules/mod_proxy_http.so
# LoadModule headers_module modules/mod_headers.so
# LoadModule rewrite_module modules/mod_rewrite.so

<VirtualHost *:80>
    ServerName your-domain.com
    ServerAdmin webmaster@your-domain.com
    DocumentRoot /home/username/domains/your-domain.com/public_html

    # If you use mod_wsgi + app.wsgi (preferred when available)
    WSGIDaemonProcess cannaspot python-path=/home/username/domains/your-domain.com/public_html/venv/lib/python3.x/site-packages
    WSGIProcessGroup cannaspot
    WSGIScriptAlias / /home/username/domains/your-domain.com/public_html/app.wsgi

    # Or (if using Gunicorn) proxy to local Gunicorn instance:
    # ProxyPreserveHost On
    # ProxyPass / http://127.0.0.1:8000/
    # ProxyPassReverse / http://127.0.0.1:8000/

    # Static files handling
    Alias /static /home/username/domains/your-domain.com/public_html/static
    Alias /uploads /home/username/domains/your-domain.com/public_html/uploads

    <Directory /home/username/domains/your-domain.com/public_html>
        Require all granted
        WSGIScriptReloading On
    </Directory>

    <Directory /home/username/domains/your-domain.com/public_html/uploads>
        Require all granted
        Options -Indexes
        <FilesMatch "\.(jpg|jpeg|png|gif|mp4|webm)$">
            Require all granted
        </FilesMatch>
    </Directory>

    # Security headers
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"

    # Large file upload settings (match Flask MAX_CONTENT_LENGTH)
    TimeOut 3600
    ProxyTimeout 3600
    LimitRequestBody 536870912  # 512MB

    ErrorLog ${APACHE_LOG_DIR}/cannaspot_error.log
    CustomLog ${APACHE_LOG_DIR}/cannaspot_access.log combined
</VirtualHost>
